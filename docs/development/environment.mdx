---
title: 'Environment'
description: 'How to get a local development environment'
---

## Initial Setup

The prefered and supported way to maintain a replicable development environment is with Docker.  Download Docker from their
website: https://www.docker.com/products/docker-desktop/ .  No subscription is required, just choose the free-est options.  You can,
of course, setup your own environment without Docker, but this is not covered in this documentation.

Once installed, simply run the following commands from the root source code folder to get started:

```sh
docker-compose build
docker-compose up
```

Next, you will need a `.env` file that contains some application secrets.  For security reasons this is not part of the repo, but
can be obtained by contacting the developers for appropriate uses.

The first time `docker-compose up` is run, your database will be initialized with a single admin: `vp@sjaa.net`.  To generate more sample data, run the following rake
task.  Make sure your docker containers are running.

```sh
docker container exec -it sjaa-memberships-app-1 bin/rake generate_data
```

Now, you should be able to navigate to https://127.0.0.1:3001 to view your local copy of the application, complete with sample data.  You may get a warning from your
browser that the connection is not secure.  This is because we use a self-signed certificate in development.  It is safe to click through those
warnings to access the app.

## Console

```sh
docker container exec -it sjaa-memberships-app-1 bin/rails c 
```

## Use Cases

The app should serve as a secure store for the membership data, and should facilitate a variety of use cases:

1. Lookup a person's membership status
    ```ruby
    p = Person.find 42
    p.active_membership
    => 
    [#<Membership:0x0000ffff8b1b3358
      id: 3568,
      start: Mon, 04 Aug 2025 00:00:00.000000000 UTC +00:00,
      term_months: 12,
      ephemeris: false,
      person_id: 1992,
      created_at: Sat, 09 Aug 2025 22:39:12.523926000 UTC +00:00,
      updated_at: Sat, 09 Aug 2025 22:39:12.523926000 UTC +00:00,
      kind_id: nil,
      donation_amount: nil,
      order_id: nil,
      end: Mon, 31 Aug 2026 23:59:59.999999000 UTC +00:00>]
    ```
1. Get a person's contact information
    ```ruby
    Person.find_by(last_name: 'Nomo').contacts
    => 
    [#<Contact:0x0000ffff80a67220
      id: 126,
      address: "123 Fake St",
      city_id: 5,
      state_id: 1,
      zipcode: "95555",
      phone: "123-456-7890",
      email: "jorge.conseco@att.net",
      primary: true,
      person_id: 126]
    ```
1. Lookup the donation history for any given member
    ```ruby
    Person.find_by(id: 42).donations
    ```
2. Lookup a person's membership renewal history
    ```ruby
    Person.find_by(id: 42).memberships
    ```
2. Lookup when a person first joined
    ```ruby
    Person.find_by(id: 42).memberships.order(start: :asc).first.start
    => Sat, 21 Sep 2019 00:00:00.000000000 UTC +00:00
    ```
1. Lookup when a person's membership expires
    ```ruby
    membership = Person.find_by(id: 42).memberships.order(start: :desc).first
    expiration = membership.start + membership.term_months.months
    => Mon, 24 Nov 2025 00:00:00.000000000 UTC +00:00
    ```
1. Find members whose memberships have lapsed
    ```ruby
    # All expired memberships
    Person.lapsed_members

    # Expired memberships who still have the "member" standing
    Person.lapsed_members(status: 'member')
    ```
